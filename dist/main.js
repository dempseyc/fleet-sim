!function(e){var t={};function s(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(i,r,function(t){return e[t]}.bind(null,r));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=1)}([function(e,t,s){},function(e,t,s){"use strict";s.r(t);s(0);function i(e,t){return Math.floor(Math.random()*t-e)+e}function r(e){return Math.pow(e,2)}class h{constructor(e){this.idx=e,this.x=i(0,1e3),this.y=i(0,1e3),this.held_by="none",this.init()}draw(){this.DOMh.style.left=`${this.x/10}%`,this.DOMh.style.top=`${this.y/10}%`}remove(){this.DOMh.remove()}init(){this.DOMh=document.createElement("div"),this.DOMh.setAttribute("id",`g-${this.idx}`),this.DOMh.classList.add(...["gold"]),this.draw()}}class n{constructor(e,t,s,i){this.color=e,this.idx=i,this.shield=s[0],this.weapon=s[1],this.engine=s[2],this.fraction=.05,this.speed=this.engine*this.fraction,this.status=0,this.shieldStatus=s[0],this.gold=0,this.init()}init(){let e=["ship",`s-${this.idx}`,`s-${this.color}`,`s-${this.style}`];this.DOMh=document.createElement("div"),this.DOMh.classList.add(...e),this.getInitialPosition(),this.draw()}move(e){this.x+=this.vx*this.fraction*this.speed*e,this.y+=this.vy*this.fraction*this.speed*e}draw(){this.DOMh.style.left=`${this.x/10}%`,this.DOMh.style.top=`${this.y/10}%`}getInitialPosition(){this.x=i(1,1e3),this.y=i(1,1e3)}resetVector(){let e=this.gt.x-this.x,t=this.gt.y-this.y,s=Math.abs(e),i=Math.abs(t),h=r(e)+r(t);this.vx=e*s/h,this.vy=t*i/h}acquireGold(){this.gold+=1}setGoldTarget(e){let t=2016400;e.forEach((e,s)=>{let i=e.x-this.x,h=e.y-this.y,n=r(i)+r(h);void 0===this.gt&&(this.gt=e,t=n),n<=t&&(this.gt=e,t=n)}),this.resetVector()}setEnemyTarget(e){let t=2e6,s=function(e){return Math.pow(e,2)};e.forEach(e=>{e.s_array.forEach(e=>{let i=this.x-e.x,r=(this.y,e.y,s(i)+s(i));void 0===this.et&&(this.et=e,t=r,this.et_d=t),r<=t&&(this.et=e,t=r,this.et_d=t)})})}attackEnemy(){let e=this.et_d/r(200);i(0,Math.floor(Math.random()*(1-e)*9))>=2&&this.et.getAttacked(this.weapon),this.incrementStunnedTimer()}getAttacked(e){console.log("damage",this.shieldStatus),this.shieldStatus-=e,this.shieldStatus<=0&&(this.speed=(this.engine+this.shieldStatus)*this.fraction),this.startStunnedTimer()}startStunnedTimer(){console.log("got stunned",this.speed),this.status=3}incrementStunnedTimer(){this.status>0&&this.status--,0===this.status&&(this.speed=this.engine*this.fraction,this.shieldStatus=this.shield)}}class o{constructor(e){this.banner=e,this.baselines={sh:20,wp:10,eg:15},this.multipliers={sh:2,wp:2,eg:2},this.features={shields:[{power:this.baselines.sh+0*this.multipliers.sh,owned_by:["gunner"]},{power:this.baselines.sh+1*this.multipliers.sh,owned_by:["swift","speeder"]},{power:this.baselines.sh+2*this.multipliers.sh,owned_by:["average"]},{power:this.baselines.sh+3*this.multipliers.sh,owned_by:[""]},{power:this.baselines.sh+4*this.multipliers.sh,owned_by:["transport"]}],weapons:[{power:this.baselines.wp+0*this.multipliers.wp,owned_by:["transport"]},{power:this.baselines.wp+1*this.multipliers.wp,owned_by:["speeder"]},{power:this.baselines.wp+2*this.multipliers.wp,owned_by:["average","swift"]},{power:this.baselines.wp+3*this.multipliers.wp,owned_by:[]},{power:this.baselines.wp+4*this.multipliers.wp,owned_by:["gunner"]}],engines:[{power:this.baselines.eg+0*this.multipliers.eg,owned_by:[]},{power:this.baselines.eg+1*this.multipliers.eg,owned_by:[]},{power:this.baselines.eg+2*this.multipliers.eg,owned_by:["average","transport","gunner"]},{power:this.baselines.eg+3*this.multipliers.eg,owned_by:["swift"]},{power:this.baselines.eg+4*this.multipliers.eg,owned_by:["speeder"]}]},this.profiles={average:[this.features.shields[2].power,this.features.weapons[2].power,this.features.engines[2].power],swift:[this.features.shields[1].power,this.features.weapons[2].power,this.features.engines[3].power],transport:[this.features.shields[4].power,this.features.weapons[0].power,this.features.engines[2].power],gunner:[this.features.shields[0].power,this.features.weapons[4].power,this.features.engines[2].power],speeder:[this.features.shields[1].power,this.features.weapons[1].power,this.features.engines[4].power]}}buildShip(e,t,s){let i=this.profiles[t];return new n(e,t,i,s)}adjustMultipliers(){for(let e in this.multipliers)this.multipliers[e]+=1}getMultipliers(){for(let e in this.multipliers)console.log(this.multipliers[e])}}class a{constructor(e,t,s){this.banner=e,this.money=t,this.s_array=[],this.strategy=s,this.sf=new o(this.banner),this.init()}getNumShips(){return this.s_array.length}purchaseShips(){let e=this.strategy.average,t=0;for(;e>t+1;)this.s_array.push(this.sf.buildShip(this.banner,"average",t)),t++}init(){console.log("new Fleet",this.banner),this.purchaseShips()}}let l=new class{constructor(){this.num_gold=900,this.money_per_fleet=15e4,this.DOMh=document.getElementById("board"),this.fleets=[new a("red",this.money_per_fleet,{average:20,swift:0,transport:0,gunner:0,speeder:0}),new a("green",this.money_per_fleet,{average:20,swift:0,transport:0,gunner:0,speeder:0}),new a("blue",this.money_per_fleet,{average:20,swift:0,transport:0,gunner:0,speeder:0})],this.gold_pieces=[],this.init()}placeGold(){for(let e=0;e<this.num_gold;e++){let t=new h(e);this.gold_pieces.push(t)}}gold_on_field(){return this.gold_pieces.filter(e=>"none"===e.held_by)}init(){this.placeGold(),this.setTargets(this.fleets),this.fleets.forEach(e=>{e.s_array.forEach(e=>{this.DOMh.appendChild(e.DOMh)})}),this.gold_pieces.forEach(e=>{this.DOMh.appendChild(e.DOMh)})}setTargets(){this.fleets.forEach((e,t)=>{let s=this.fleets.filter((e,s)=>s!==t);e.s_array.forEach(e=>{e.setGoldTarget(this.gold_on_field()),e.setEnemyTarget(s)})})}makeAttacks(){this.fleets.forEach((e,t)=>{e.s_array.forEach(e=>{e.attackEnemy()})})}doHitDetect(){this.fleets.forEach(e=>{e.s_array.forEach(e=>{this.gold_pieces.forEach(t=>{r(t.x-e.x)+r(t.y-e.y)<25&&"none"===t.held_by&&this.removeGold(t,e)})})})}removeGold(e,t){e.held_by=t.profile,t.acquireGold(),this.setTargets(this.fleets),e.remove()}draw(){this.doHitDetect(),this.fleets.forEach(e=>{e.s_array.forEach(e=>{e.draw()})})}update(e){this.fleets.forEach(t=>{t.s_array.forEach(t=>{t.move(e)})})}oneSecUpdate(){this.makeAttacks()}twoSecUpdate(){this.setTargets()}},p=0,d=0,u=0,f=100,c=0,w=10,g=!1,y=!1;let m=0,b=0;function _(e){if(e<u+1e3/f)return void(p=requestAnimationFrame(_));c+=e-u,u=e;let t=0;for(;c>=w;)if(++b>74&&(l.oneSecUpdate(),b=0),++m>199&&(l.twoSecUpdate(),m=0),l.update(c),c-=w,++t>=124){c=0,console.log("panic");break}l.draw(),l.gold_on_field().length>0?p=requestAnimationFrame(_):(g=!1,y=!1,cancelAnimationFrame(p),l.fleets.forEach((e,t)=>{let s=e.s_array.reduce((e,t,s)=>e+t.gold,0);console.log(t+1,e.banner,s)}))}y||(y=!0,p=requestAnimationFrame(function(e){l.draw(),g=!0,u=e,d=e,p=requestAnimationFrame(_)}))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzLmpzIiwid2VicGFjazovLy8uL3NyYy9Hb2xkUGllY2UuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1NoaXAuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1NoaXBGYWN0b3J5LmpzIiwid2VicGFjazovLy8uL3NyYy9GbGVldC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0JvYXJkLmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwicmFuZG9tTU0iLCJtaW4iLCJtYXgiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJzcXVhcmVOdW0iLCJwb3ciLCJHb2xkUGllY2VfR29sZFBpZWNlIiwiW29iamVjdCBPYmplY3RdIiwiaWR4IiwidGhpcyIsIngiLCJ5IiwiaGVsZF9ieSIsImluaXQiLCJET01oIiwic3R5bGUiLCJsZWZ0IiwidG9wIiwicmVtb3ZlIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiY2xhc3NMaXN0IiwiYWRkIiwiZHJhdyIsIlNoaXBfU2hpcCIsImNvbG9yIiwicHJvZmlsZSIsInNoaWVsZCIsIndlYXBvbiIsImVuZ2luZSIsImZyYWN0aW9uIiwic3BlZWQiLCJzdGF0dXMiLCJzaGllbGRTdGF0dXMiLCJnb2xkIiwiY2xhc3NlcyIsImdldEluaXRpYWxQb3NpdGlvbiIsImRlbHRhIiwidngiLCJ2eSIsIm12eCIsImd0IiwibXZ5IiwiYW12eCIsImFicyIsImFtdnkiLCJtYWciLCJnb2xkX29uX2ZpZWxkIiwiZ3RfZGlzdGFuY2Vfc3EiLCJmb3JFYWNoIiwiaV9nIiwieF9kaXN0YW5jZSIsInlfZGlzdGFuY2UiLCJpX2dfZGlzdGFuY2Vfc3EiLCJyZXNldFZlY3RvciIsImVuZW1pZXMiLCJldF9kaXN0YW5jZV9zcSIsImYiLCJzX2FycmF5IiwiaV9lIiwiaV9lX2Rpc3RhbmNlX3NxIiwiZXQiLCJldF9kIiwibWlzc19yYXRlIiwiZ2V0QXR0YWNrZWQiLCJpbmNyZW1lbnRTdHVubmVkVGltZXIiLCJkYW1hZ2UiLCJjb25zb2xlIiwibG9nIiwic3RhcnRTdHVubmVkVGltZXIiLCJTaGlwRmFjdG9yeV9TaGlwRmFjdG9yeSIsImJhbm5lciIsImJhc2VsaW5lcyIsInNoIiwid3AiLCJlZyIsIm11bHRpcGxpZXJzIiwiZmVhdHVyZXMiLCJzaGllbGRzIiwicG93ZXIiLCJvd25lZF9ieSIsIndlYXBvbnMiLCJlbmdpbmVzIiwicHJvZmlsZXMiLCJhdmVyYWdlIiwic3dpZnQiLCJ0cmFuc3BvcnQiLCJndW5uZXIiLCJzcGVlZGVyIiwiRmxlZXRfRmxlZXQiLCJtb25leSIsInN0cmF0ZWd5Iiwic2YiLCJsZW5ndGgiLCJudW1BViIsInB1c2giLCJidWlsZFNoaXAiLCJwdXJjaGFzZVNoaXBzIiwic2ltQm9hcmQiLCJudW1fZ29sZCIsIm1vbmV5X3Blcl9mbGVldCIsImdldEVsZW1lbnRCeUlkIiwiZmxlZXRzIiwiZ29sZF9waWVjZXMiLCJncCIsImZpbHRlciIsImciLCJwbGFjZUdvbGQiLCJzZXRUYXJnZXRzIiwiYXBwZW5kQ2hpbGQiLCJmZiIsInNldEdvbGRUYXJnZXQiLCJzZXRFbmVteVRhcmdldCIsImF0dGFja0VuZW15IiwicmVtb3ZlR29sZCIsImFjcXVpcmVHb2xkIiwiZG9IaXREZXRlY3QiLCJtb3ZlIiwibWFrZUF0dGFja3MiLCJmcmFtZUlEIiwibGFzdEZwc1VwZGF0ZSIsImxhc3RGcmFtZVRpbWVNcyIsIm1heEZQUyIsInRpbWVzdGVwIiwicnVubmluZyIsInN0YXJ0ZWQiLCJpaV9jb3VudGVyIiwiaV9jb3VudGVyIiwibWFpbkxvb3AiLCJ0aW1lc3RhbXAiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJudW1VcGRhdGVTdGVwcyIsIm9uZVNlY1VwZGF0ZSIsInR3b1NlY1VwZGF0ZSIsInVwZGF0ZSIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwicmVkdWNlIiwiYSJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsRUFBQSxHQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLEdBQUEsQ0FDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxRQUFBLElBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQUtBRixFQUFBUSxFQUFBRixFQUdBTixFQUFBUyxFQUFBVixFQUdBQyxFQUFBVSxFQUFBLFNBQUFSLEVBQUFTLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFYLEVBQUFTLElBQ0FHLE9BQUFDLGVBQUFiLEVBQUFTLEVBQUEsQ0FBMENLLFlBQUEsRUFBQUMsSUFBQUwsS0FLMUNaLEVBQUFrQixFQUFBLFNBQUFoQixHQUNBLG9CQUFBaUIsZUFBQUMsYUFDQU4sT0FBQUMsZUFBQWIsRUFBQWlCLE9BQUFDLFlBQUEsQ0FBd0RDLE1BQUEsV0FFeERQLE9BQUFDLGVBQUFiLEVBQUEsY0FBaURtQixPQUFBLEtBUWpEckIsRUFBQXNCLEVBQUEsU0FBQUQsRUFBQUUsR0FFQSxHQURBLEVBQUFBLElBQUFGLEVBQUFyQixFQUFBcUIsSUFDQSxFQUFBRSxFQUFBLE9BQUFGLEVB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QUFGLElBS0EzRixHQUFBNEYsRUFBQVIsRUFDQUEsRUFBQVEsRUFFQSxJQUFBRSxFQUFBLEVBQ0EsS0FBQTlGLEdBQUFzRixHQWVBLEtBZEFJLEVBQ0EsS0FxQ0E3QixFQUFBa0MsZUFsQ0FMLEVBQUEsS0FFQUQsRUFDQSxNQTJCQTVCLEVBQUFtQyxlQXhCQVAsRUFBQSxHQUVBNUIsRUFBQW9DLE9BQUFqRyxHQUNBQSxHQUFBc0YsSUFDQVEsR0FBQSxLQWxDQTlGLEVBQUEsRUFDQThCLFFBQUFDLElBQUEsU0FvQ0EsTUFHQThCLEVBQUEzRSxPQUdBMkUsRUFBQW5ELGdCQUFBOEMsT0FHQSxFQUNBMEIsRUFBQVcsc0JBQUFGLElBdEVBSixHQUFBLEVBQ0FDLEdBQUEsRUFDQVUscUJBQUFoQixHQXVGQXJCLEVBQUFJLE9BQUFyRCxRQUFBLENBQUFRLEVBQUE1RixLQUNBLElBQUFxRSxFQUFBdUIsRUFBQUMsUUFBQThFLE9BQUEsQ0FBQUMsRUFBQTdJLEVBQUEvQixJQUNBNEssRUFBQTdJLEVBQUFzQyxLQUNTLEdBQ1RpQyxRQUFBQyxJQUFBdkcsRUFBQSxFQUFBNEYsRUFBQWMsT0FBQXJDLE1BdkZBMkYsSUFDQUEsR0FBQSxFQUdBTixFQUFBVyxzQkFBQSxTQUFBRCxHQUNBL0IsRUFBQTNFLE9BQ0FxRyxHQUFBLEVBRUFILEVBQUFRLEVBQ0FULEVBQUFTLEVBRUFWLEVBQUFXLHNCQUFBRiIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuIiwiZXhwb3J0IGZ1bmN0aW9uIHJhbmRvbU1NIChtaW4sbWF4KSB7XG4gIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqbWF4LW1pbikrbWluO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHNxdWFyZU51bSAobikge1xuICByZXR1cm4gTWF0aC5wb3cobiwyKTtcbn07IiwiaW1wb3J0IHsgcmFuZG9tTU0gfSBmcm9tICcuL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIEdvbGRQaWVjZSB7XG5cdGNvbnN0cnVjdG9yIChpZHgpIHtcblx0XHR0aGlzLmlkeCA9IGlkeDtcblx0XHR0aGlzLnggPSByYW5kb21NTSgwLDEwMDApO1xuXHRcdHRoaXMueSA9IHJhbmRvbU1NKDAsMTAwMCk7XG5cdFx0dGhpcy5oZWxkX2J5ID0gXCJub25lXCI7XG5cdFx0dGhpcy5pbml0KCk7XG5cdH1cblxuXHRkcmF3ICgpIHtcblx0XHR0aGlzLkRPTWguc3R5bGUubGVmdCA9IGAke3RoaXMueC8xMH0lYDtcblx0XHR0aGlzLkRPTWguc3R5bGUudG9wID0gYCR7dGhpcy55LzEwfSVgO1xuXHR9XG5cblx0cmVtb3ZlICgpIHtcblx0XHR0aGlzLkRPTWgucmVtb3ZlKCk7XG5cdH1cblxuXHRpbml0KCkge1xuXHRcdGxldCBjbGFzc2VzID0gWydnb2xkJ107XG5cdFx0dGhpcy5ET01oID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0dGhpcy5ET01oLnNldEF0dHJpYnV0ZShcImlkXCIsIGBnLSR7dGhpcy5pZHh9YCk7XG5cdFx0dGhpcy5ET01oLmNsYXNzTGlzdC5hZGQoLi4uY2xhc3Nlcyk7XG5cdFx0dGhpcy5kcmF3KCk7XG5cdH1cbn0iLCJpbXBvcnQgeyByYW5kb21NTSwgc3F1YXJlTnVtIH0gZnJvbSAnLi91dGlscy5qcyc7XG5cbmV4cG9ydCBjbGFzcyBTaGlwIHtcblxuXHRjb25zdHJ1Y3RvciAoY29sb3IsIHN0eWxlLCBwcm9maWxlLCBpZHgpIHtcblx0XHR0aGlzLmNvbG9yID0gY29sb3I7XG5cdFx0dGhpcy5pZHggPSBpZHg7XG5cdFx0dGhpcy5zaGllbGQgPSBwcm9maWxlWzBdO1xuXHRcdHRoaXMud2VhcG9uID0gcHJvZmlsZVsxXTtcblx0XHR0aGlzLmVuZ2luZSA9IHByb2ZpbGVbMl07XG5cdFx0dGhpcy5mcmFjdGlvbiA9IDAuMDU7XG5cdFx0dGhpcy5zcGVlZCA9IHRoaXMuZW5naW5lICogdGhpcy5mcmFjdGlvbjtcblx0XHR0aGlzLnN0YXR1cyA9IDA7XG5cdFx0dGhpcy5zaGllbGRTdGF0dXMgPSBwcm9maWxlWzBdO1xuXHRcdHRoaXMuZ29sZCA9IDA7XG5cdFx0Ly8gdGhpcy5nZXRBdHRhY2tlZCA9IHRoaXMuZ2V0QXR0YWNrZWQuYmluZCh0aGlzKTtcblxuXHRcdHRoaXMuaW5pdCgpO1xuXHRcdC8vIGNvbnNvbGUubG9nKHRoaXMpO1xuXHR9IC8vIGVuZCBTaGlwIGNvbnN0cnVjdG9yXG5cblx0Ly9tZXRob2RzXG5cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBpbml0XG5cdGluaXQgKCkge1xuXHRcdGxldCBjbGFzc2VzID0gWydzaGlwJyxgcy0ke3RoaXMuaWR4fWAsIGBzLSR7dGhpcy5jb2xvcn1gLCBgcy0ke3RoaXMuc3R5bGV9YF07XG5cdFx0dGhpcy5ET01oID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0dGhpcy5ET01oLmNsYXNzTGlzdC5hZGQoLi4uY2xhc3Nlcyk7XG5cdFx0dGhpcy5nZXRJbml0aWFsUG9zaXRpb24oKTtcblx0XHR0aGlzLmRyYXcoKTtcblx0fVxuXG5cdG1vdmUgKGRlbHRhKSB7XG5cdFx0dGhpcy54ICs9IHRoaXMudnggKiB0aGlzLmZyYWN0aW9uICogdGhpcy5zcGVlZCAqIGRlbHRhO1xuXHRcdHRoaXMueSArPSB0aGlzLnZ5ICogdGhpcy5mcmFjdGlvbiAqIHRoaXMuc3BlZWQgKiBkZWx0YTtcblx0fVxuXG5cdGRyYXcgKCkge1xuXHRcdHRoaXMuRE9NaC5zdHlsZS5sZWZ0ID0gYCR7dGhpcy54LzEwfSVgO1xuXHRcdHRoaXMuRE9NaC5zdHlsZS50b3AgPSBgJHt0aGlzLnkvMTB9JWA7XG5cdH1cblxuXHRnZXRJbml0aWFsUG9zaXRpb24gKCkge1xuXHRcdHRoaXMueCA9IHJhbmRvbU1NKDEsMTAwMCk7XG5cdFx0dGhpcy55ID0gcmFuZG9tTU0oMSwxMDAwKTtcblx0fVxuXG5cdHJlc2V0VmVjdG9yICgpIHtcblx0XHRsZXQgbXZ4ID0gdGhpcy5ndC54IC0gdGhpcy54O1xuXHRcdGxldCBtdnkgPSB0aGlzLmd0LnkgLSB0aGlzLnk7XG5cdFx0bGV0IGFtdnggPSBNYXRoLmFicyhtdngpO1xuXHRcdGxldCBhbXZ5ID0gTWF0aC5hYnMobXZ5KTtcblx0XHRsZXQgbWFnID0gc3F1YXJlTnVtKG12eCkrc3F1YXJlTnVtKG12eSk7XG5cdFx0dGhpcy52eCA9IG12eCphbXZ4IC8gbWFnO1xuXHRcdHRoaXMudnkgPSBtdnkqYW12eSAvIG1hZztcblx0XHQvLyBjb25zb2xlLmxvZyh0aGlzLnZ4LHRoaXMudnkpO1xuXHR9XG5cblx0YWNxdWlyZUdvbGQgKCkge1xuXHRcdHRoaXMuZ29sZCArPSAxO1xuXHRcdC8vIGNvbnNvbGUubG9nKHRoaXMuYXNzZXRzKTtcblx0fVxuXG5cdHNldEdvbGRUYXJnZXQoZ29sZF9vbl9maWVsZCkge1xuXG5cdFx0bGV0IGd0X2Rpc3RhbmNlX3NxID0gMjAxNjQgKiAxMDA7ICAvLyBzaG91bGRuJ3QgbWF0dGVyXG5cblx0XHRnb2xkX29uX2ZpZWxkLmZvckVhY2goKGlfZywgaSkgPT4ge1xuXHRcdFx0bGV0IHhfZGlzdGFuY2UgPSBpX2cueCAtIHRoaXMueDtcblx0XHRcdGxldCB5X2Rpc3RhbmNlID0gaV9nLnkgLSB0aGlzLnk7XG5cdFx0XHRsZXQgaV9nX2Rpc3RhbmNlX3NxID0gc3F1YXJlTnVtKHhfZGlzdGFuY2UpICsgc3F1YXJlTnVtKHlfZGlzdGFuY2UpO1xuXG5cdFx0XHRpZiAodHlwZW9mKHRoaXMuZ3QpID09PSAndW5kZWZpbmVkJykge1xuXHRcdFx0XHR0aGlzLmd0ID0gaV9nO1xuXHRcdFx0XHRndF9kaXN0YW5jZV9zcSA9IGlfZ19kaXN0YW5jZV9zcTtcblx0XHRcdH1cblx0XHRcdGlmIChpX2dfZGlzdGFuY2Vfc3EgPD0gZ3RfZGlzdGFuY2Vfc3EpIHtcblx0XHRcdFx0dGhpcy5ndCA9IGlfZztcblx0XHRcdFx0Z3RfZGlzdGFuY2Vfc3EgPSBpX2dfZGlzdGFuY2Vfc3E7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0Ly8gY29uc29sZS5sb2coZ3RfZGlzdGFuY2Vfc3EsIFwiZ3QgZGlzdGFuY2VcIik7XG5cdFx0dGhpcy5yZXNldFZlY3RvcigpO1xuXHR9XG5cblx0c2V0RW5lbXlUYXJnZXQoZW5lbWllcykge1xuXHRcdGxldCBldF9kaXN0YW5jZV9zcSA9IDEwMDAgKiAxMDAwICogMjtcblxuXHRcdGxldCBzcXVhcmVOdW0gPSBmdW5jdGlvbiAobikgeyByZXR1cm4gTWF0aC5wb3cobiwyKTsgfTtcblxuXHRcdGVuZW1pZXMuZm9yRWFjaCgoZikgPT4ge1xuXHRcdFx0Zi5zX2FycmF5LmZvckVhY2goKGlfZSkgPT4ge1xuXHRcdFx0XHRsZXQgeF9kaXN0YW5jZSA9IHRoaXMueCAtIGlfZS54O1xuXHRcdFx0XHRsZXQgeV9kaXN0YW5jZSA9IHRoaXMueSAtIGlfZS55O1xuXHRcdFx0XHRsZXQgaV9lX2Rpc3RhbmNlX3NxID0gc3F1YXJlTnVtKHhfZGlzdGFuY2UpICsgc3F1YXJlTnVtKHhfZGlzdGFuY2UpO1xuXG5cdFx0XHRcdGlmICh0eXBlb2YodGhpcy5ldCkgPT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRcdFx0dGhpcy5ldCA9IGlfZTtcblx0XHRcdFx0XHRldF9kaXN0YW5jZV9zcSA9IGlfZV9kaXN0YW5jZV9zcTtcblx0XHRcdFx0XHR0aGlzLmV0X2QgPSBldF9kaXN0YW5jZV9zcTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoaV9lX2Rpc3RhbmNlX3NxIDw9IGV0X2Rpc3RhbmNlX3NxKSB7XG5cdFx0XHRcdFx0dGhpcy5ldCA9IGlfZTtcblx0XHRcdFx0XHRldF9kaXN0YW5jZV9zcSA9IGlfZV9kaXN0YW5jZV9zcTtcblx0XHRcdFx0XHR0aGlzLmV0X2QgPSBldF9kaXN0YW5jZV9zcTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxuXHRhdHRhY2tFbmVteSgpIHtcblx0XHRsZXQgbWF4X2RfYXR0YWNrID0gMjAwO1xuXHRcdGxldCBtaXNzX3JhdGUgPSB0aGlzLmV0X2QgLyBzcXVhcmVOdW0obWF4X2RfYXR0YWNrKSA7XG5cdFx0bGV0IGFjY3VyYWN5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKigxLW1pc3NfcmF0ZSkqOSk7XG5cdFx0bGV0IHJhbiA9IHJhbmRvbU1NKDAsYWNjdXJhY3kpO1xuXHRcdGlmIChyYW4gPj0gMikge1xuXHRcdFx0dGhpcy5ldC5nZXRBdHRhY2tlZCh0aGlzLndlYXBvbik7XG5cdFx0fVxuXHRcdHRoaXMuaW5jcmVtZW50U3R1bm5lZFRpbWVyKCk7XG5cdH1cblxuXHRnZXRBdHRhY2tlZChkYW1hZ2UpIHtcblx0XHRjb25zb2xlLmxvZyhcImRhbWFnZVwiLCB0aGlzLnNoaWVsZFN0YXR1cyk7XG5cdFx0dGhpcy5zaGllbGRTdGF0dXMgLT0gZGFtYWdlO1xuXHRcdGlmICh0aGlzLnNoaWVsZFN0YXR1czw9MCkge1xuXHRcdFx0dGhpcy5zcGVlZCA9ICh0aGlzLmVuZ2luZSt0aGlzLnNoaWVsZFN0YXR1cykgKiB0aGlzLmZyYWN0aW9uO1xuXHRcdH1cblx0XHR0aGlzLnN0YXJ0U3R1bm5lZFRpbWVyKCk7XG5cdH1cblxuXHRzdGFydFN0dW5uZWRUaW1lciAoKSB7XG5cdFx0Y29uc29sZS5sb2coXCJnb3Qgc3R1bm5lZFwiLCB0aGlzLnNwZWVkKTtcblx0XHR0aGlzLnN0YXR1cyA9IDM7XG5cdH1cblxuXHRpbmNyZW1lbnRTdHVubmVkVGltZXIgKCkge1xuXHRcdGlmICh0aGlzLnN0YXR1cyA+IDApIHtcblx0XHRcdHRoaXMuc3RhdHVzLS07XG5cdFx0fVxuXHRcdGlmICh0aGlzLnN0YXR1cyA9PT0gMCkge1xuXHRcdFx0dGhpcy5zcGVlZCA9IHRoaXMuZW5naW5lICogdGhpcy5mcmFjdGlvbjtcblx0XHRcdHRoaXMuc2hpZWxkU3RhdHVzID0gdGhpcy5zaGllbGQ7XG5cdFx0fVxuXHR9XG5cbn0iLCJpbXBvcnQgeyByYW5kb21NTSB9IGZyb20gJy4vdXRpbHMuanMnO1xuaW1wb3J0IHsgU2hpcCB9IGZyb20gJy4vU2hpcC5qcyc7XG5cbmV4cG9ydCBjbGFzcyBTaGlwRmFjdG9yeSB7XG5cbiAgICBjb25zdHJ1Y3RvciAoYmFubmVyKSB7XG4gICAgICAgIHRoaXMuYmFubmVyID0gYmFubmVyO1xuICAgICAgICB0aGlzLmJhc2VsaW5lcyA9IHtcbiAgICAgICAgICAgIHNoOiAyMCxcbiAgICAgICAgICAgIHdwOiAxMCxcbiAgICAgICAgICAgIGVnOiAxNVxuICAgICAgICB9XG4gICAgICAgIHRoaXMubXVsdGlwbGllcnMgPSAge1xuICAgICAgICAgICAgc2g6IDIsXG4gICAgICAgICAgICB3cDogMixcbiAgICAgICAgICAgIGVnOiAyXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5mZWF0dXJlcyA9IHtcbiAgICAgICAgICAgIHNoaWVsZHM6IFtcbiAgICAgICAgICAgICAgICB7cG93ZXI6IHRoaXMuYmFzZWxpbmVzLnNoKyh0aGlzLm11bHRpcGxpZXJzLnNoKjApLCBvd25lZF9ieTogWydndW5uZXInXX0sXG4gICAgICAgICAgICAgICAge3Bvd2VyOiB0aGlzLmJhc2VsaW5lcy5zaCsodGhpcy5tdWx0aXBsaWVycy5zaCoxKSwgb3duZWRfYnk6IFsnc3dpZnQnLCdzcGVlZGVyJ119LFxuICAgICAgICAgICAgICAgIHtwb3dlcjogdGhpcy5iYXNlbGluZXMuc2grKHRoaXMubXVsdGlwbGllcnMuc2gqMiksIG93bmVkX2J5OiBbJ2F2ZXJhZ2UnXX0sXG4gICAgICAgICAgICAgICAge3Bvd2VyOiB0aGlzLmJhc2VsaW5lcy5zaCsodGhpcy5tdWx0aXBsaWVycy5zaCozKSwgb3duZWRfYnk6IFsnJ119LFxuICAgICAgICAgICAgICAgIHtwb3dlcjogdGhpcy5iYXNlbGluZXMuc2grKHRoaXMubXVsdGlwbGllcnMuc2gqNCksIG93bmVkX2J5OiBbJ3RyYW5zcG9ydCddfVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHdlYXBvbnM6IFtcbiAgICAgICAgICAgICAgICB7cG93ZXI6IHRoaXMuYmFzZWxpbmVzLndwKyh0aGlzLm11bHRpcGxpZXJzLndwKjApLCBvd25lZF9ieTogWyd0cmFuc3BvcnQnXX0sXG4gICAgICAgICAgICAgICAge3Bvd2VyOiB0aGlzLmJhc2VsaW5lcy53cCsodGhpcy5tdWx0aXBsaWVycy53cCoxKSwgb3duZWRfYnk6IFsnc3BlZWRlciddfSxcbiAgICAgICAgICAgICAgICB7cG93ZXI6IHRoaXMuYmFzZWxpbmVzLndwKyh0aGlzLm11bHRpcGxpZXJzLndwKjIpLCBvd25lZF9ieTogWydhdmVyYWdlJywgJ3N3aWZ0J119LFxuICAgICAgICAgICAgICAgIHtwb3dlcjogdGhpcy5iYXNlbGluZXMud3ArKHRoaXMubXVsdGlwbGllcnMud3AqMyksIG93bmVkX2J5OiBbXX0sXG4gICAgICAgICAgICAgICAge3Bvd2VyOiB0aGlzLmJhc2VsaW5lcy53cCsodGhpcy5tdWx0aXBsaWVycy53cCo0KSwgb3duZWRfYnk6IFsnZ3VubmVyJ119XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgZW5naW5lczogW1xuICAgICAgICAgICAgICAgIHtwb3dlcjogdGhpcy5iYXNlbGluZXMuZWcrKHRoaXMubXVsdGlwbGllcnMuZWcqMCksIG93bmVkX2J5OiBbXX0sXG4gICAgICAgICAgICAgICAge3Bvd2VyOiB0aGlzLmJhc2VsaW5lcy5lZysodGhpcy5tdWx0aXBsaWVycy5lZyoxKSwgb3duZWRfYnk6IFtdfSxcbiAgICAgICAgICAgICAgICB7cG93ZXI6IHRoaXMuYmFzZWxpbmVzLmVnKyh0aGlzLm11bHRpcGxpZXJzLmVnKjIpLCBvd25lZF9ieTogWydhdmVyYWdlJywndHJhbnNwb3J0JywnZ3VubmVyJ119LFxuICAgICAgICAgICAgICAgIHtwb3dlcjogdGhpcy5iYXNlbGluZXMuZWcrKHRoaXMubXVsdGlwbGllcnMuZWcqMyksIG93bmVkX2J5OiBbJ3N3aWZ0J119LFxuICAgICAgICAgICAgICAgIHtwb3dlcjogdGhpcy5iYXNlbGluZXMuZWcrKHRoaXMubXVsdGlwbGllcnMuZWcqNCksIG93bmVkX2J5OiBbJ3NwZWVkZXInXX1cbiAgICAgICAgICAgIF1cbiAgICAgICAgfTtcblxuICAgIC8vIGxvb2t1cCByZXZlcnNlZCBmcm9tIGZlYXR1cmVzXG4gICAgICAgIHRoaXMucHJvZmlsZXMgPSB7XG4gICAgICAgICAgICBhdmVyYWdlOiBbdGhpcy5mZWF0dXJlcy5zaGllbGRzWzJdLnBvd2VyLHRoaXMuZmVhdHVyZXMud2VhcG9uc1syXS5wb3dlcix0aGlzLmZlYXR1cmVzLmVuZ2luZXNbMl0ucG93ZXJdLFxuICAgICAgICAgICAgc3dpZnQ6IFt0aGlzLmZlYXR1cmVzLnNoaWVsZHNbMV0ucG93ZXIsdGhpcy5mZWF0dXJlcy53ZWFwb25zWzJdLnBvd2VyLHRoaXMuZmVhdHVyZXMuZW5naW5lc1szXS5wb3dlcl0sXG4gICAgICAgICAgICB0cmFuc3BvcnQ6IFt0aGlzLmZlYXR1cmVzLnNoaWVsZHNbNF0ucG93ZXIsdGhpcy5mZWF0dXJlcy53ZWFwb25zWzBdLnBvd2VyLHRoaXMuZmVhdHVyZXMuZW5naW5lc1syXS5wb3dlcl0sXG4gICAgICAgICAgICBndW5uZXI6IFt0aGlzLmZlYXR1cmVzLnNoaWVsZHNbMF0ucG93ZXIsdGhpcy5mZWF0dXJlcy53ZWFwb25zWzRdLnBvd2VyLHRoaXMuZmVhdHVyZXMuZW5naW5lc1syXS5wb3dlcl0sXG4gICAgICAgICAgICBzcGVlZGVyOiBbdGhpcy5mZWF0dXJlcy5zaGllbGRzWzFdLnBvd2VyLHRoaXMuZmVhdHVyZXMud2VhcG9uc1sxXS5wb3dlcix0aGlzLmZlYXR1cmVzLmVuZ2luZXNbNF0ucG93ZXJdXG4gICAgICAgIH1cbiAgICB9IC8vIGNvbnN0cnVjdG9yXG5cbiAgICBidWlsZFNoaXAgKGNvbG9yLHN0eWxlLGlkeCkge1xuICAgICAgICBsZXQgcHJvZmlsZSA9IHRoaXMucHJvZmlsZXNbc3R5bGVdO1xuICAgICAgICByZXR1cm4gbmV3IFNoaXAoY29sb3Isc3R5bGUscHJvZmlsZSxpZHgpO1xuICAgIH1cblxuICAgIC8vIGFkanVzdCBtdWx0aXBsaWVyc1xuICAgIGFkanVzdE11bHRpcGxpZXJzICgpIHtcbiAgICAgICAgZm9yIChsZXQga2V5IGluIHRoaXMubXVsdGlwbGllcnMpIHtcbiAgICAgICAgICAgIHRoaXMubXVsdGlwbGllcnNba2V5XSArPTE7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRNdWx0aXBsaWVycyAoKSB7XG4gICAgICAgIGZvciAobGV0IGtleSBpbiB0aGlzLm11bHRpcGxpZXJzKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLm11bHRpcGxpZXJzW2tleV0pO1xuICAgICAgICB9XG4gICAgfVxuXG59IiwiaW1wb3J0IFNoaXAgZnJvbSAnLi9TaGlwLmpzJztcbmltcG9ydCB7IFNoaXBGYWN0b3J5IH0gZnJvbSAnLi9TaGlwRmFjdG9yeS5qcyc7XG5cbmV4cG9ydCBjbGFzcyBGbGVldCB7XG5cblx0Y29uc3RydWN0b3IgKGJhbm5lcixtb25leSxzdHJhdGVneSkge1xuXHRcdHRoaXMuYmFubmVyID0gYmFubmVyO1xuXHRcdHRoaXMubW9uZXkgPSBtb25leTtcblx0XHR0aGlzLnNfYXJyYXkgPSBbXTtcblx0XHR0aGlzLnN0cmF0ZWd5ID0gc3RyYXRlZ3k7XG5cdFx0dGhpcy5zZiA9IG5ldyBTaGlwRmFjdG9yeSh0aGlzLmJhbm5lcik7XG5cdFx0dGhpcy5pbml0KCk7XG5cdH1cblxuXHRnZXROdW1TaGlwcyAoKSB7XG5cdFx0cmV0dXJuIHRoaXMuc19hcnJheS5sZW5ndGg7XG5cdH1cblxuXHRwdXJjaGFzZVNoaXBzICgpIHtcblx0XHQvL3RoaXMuc3RyYXRlZ3kgPSB7YXZlcmFnZToxMDAsc3dpZnQ6MCx0cmFuc3BvcnQ6MCxndW5uZXI6MCxzcGVlZGVyOjB9O1xuXHRcdGxldCBudW1BViA9IHRoaXMuc3RyYXRlZ3kuYXZlcmFnZTtcblx0XHRsZXQgaSA9IDA7XG5cdFx0d2hpbGUgKG51bUFWPmkrMSkge1xuXHRcdFx0dGhpcy5zX2FycmF5LnB1c2godGhpcy5zZi5idWlsZFNoaXAodGhpcy5iYW5uZXIsJ2F2ZXJhZ2UnLGkpKTtcblx0XHRcdGkrKztcblx0XHR9XG5cdH1cblxuXHRpbml0ICgpIHtcblx0XHRjb25zb2xlLmxvZygnbmV3IEZsZWV0JywgdGhpcy5iYW5uZXIpO1xuXHRcdHRoaXMucHVyY2hhc2VTaGlwcygpO1xuXHR9XG5cbn0iLCJpbXBvcnQgJy4vc3R5bGUuY3NzJztcbmltcG9ydCB7IEJvYXJkIH0gZnJvbSAnLi9Cb2FyZC5qcyc7XG5cbmxldCBzaW1Cb2FyZCA9IG5ldyBCb2FyZCgpO1xuXG5sZXQgZnJhbWVJRCA9IDAsXG4gICAgbGFzdEZwc1VwZGF0ZSA9IDAsXG4gICAgbGFzdEZyYW1lVGltZU1zID0gMCxcbiAgICBtYXhGUFMgPSAxMDAsXG4gICAgZGVsdGEgPSAwLFxuICAgIHRpbWVzdGVwID0gMTAwMCAvIDEwMDtcblxubGV0IHJ1bm5pbmcgPSBmYWxzZSxcbiAgICBzdGFydGVkID0gZmFsc2U7XG4gICAgXG5mdW5jdGlvbiBzdG9wKCkge1xuICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICBzdGFydGVkID0gZmFsc2U7XG4gICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUoZnJhbWVJRCk7XG59XG5cbmZ1bmN0aW9uIHN0YXJ0KCkge1xuICAgIGlmICghc3RhcnRlZCkgeyAvLyBkb24ndCByZXF1ZXN0IG11bHRpcGxlIGZyYW1lc1xuICAgICAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgLy8gRHVtbXkgZnJhbWUgdG8gZ2V0IG91ciB0aW1lc3RhbXBzIGFuZCBpbml0aWFsIGRyYXdpbmcgcmlnaHQuXG4gICAgICAgIC8vIFRyYWNrIHRoZSBmcmFtZSBJRCBzbyB3ZSBjYW4gY2FuY2VsIGl0IGlmIHdlIHN0b3AgcXVpY2tseS5cbiAgICAgICAgZnJhbWVJRCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbih0aW1lc3RhbXApIHtcbiAgICAgICAgICAgIHNpbUJvYXJkLmRyYXcoKTsgLy8gaW5pdGlhbCBzaW1Cb2FyZC5kcmF3XG4gICAgICAgICAgICBydW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIC8vIHJlc2V0IHNvbWUgdGltZSB0cmFja2luZyBsZXRhYmxlc1xuICAgICAgICAgICAgbGFzdEZyYW1lVGltZU1zID0gdGltZXN0YW1wO1xuICAgICAgICAgICAgbGFzdEZwc1VwZGF0ZSA9IHRpbWVzdGFtcDtcbiAgICAgICAgICAgIC8vIGFjdHVhbGx5IHN0YXJ0IHRoZSBtYWluIGxvb3BcbiAgICAgICAgICAgIGZyYW1lSUQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobWFpbkxvb3ApO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHBhbmljKCkge1xuICAgIGRlbHRhID0gMDtcbiAgICBjb25zb2xlLmxvZyhcInBhbmljXCIpO1xufVxuXG5sZXQgaWlfY291bnRlciA9IDA7XG5sZXQgaV9jb3VudGVyID0gMDtcblxuZnVuY3Rpb24gbWFpbkxvb3AodGltZXN0YW1wKSB7XG4gICAgLy8gdGhyb3R0bGUgdGhlIGZyYW1lIHJhdGUgIFxuICAgIGlmICh0aW1lc3RhbXAgPCBsYXN0RnJhbWVUaW1lTXMgKyAoMTAwMCAvIG1heEZQUykpIHtcbiAgICAgICAgZnJhbWVJRCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShtYWluTG9vcCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgXG4gICAgLy8gY3JlYXRlIHZpcnR1YWwgdGltZVxuICAgIGRlbHRhICs9IHRpbWVzdGFtcCAtIGxhc3RGcmFtZVRpbWVNcztcbiAgICBsYXN0RnJhbWVUaW1lTXMgPSB0aW1lc3RhbXA7XG5cbiAgICBsZXQgbnVtVXBkYXRlU3RlcHMgPSAwO1xuICAgIHdoaWxlIChkZWx0YSA+PSB0aW1lc3RlcCkge1xuICAgICAgICBpX2NvdW50ZXIrKztcbiAgICAgICAgaWYgKGlfY291bnRlciA+IDc0KSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhpX2NvdW50ZXIpO1xuICAgICAgICAgICAgZXZlcnlfNzVfZnJhbWVzKCk7XG4gICAgICAgICAgICBpX2NvdW50ZXIgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlpX2NvdW50ZXIrKztcbiAgICAgICAgaWYgKGlpX2NvdW50ZXIgPiAxOTkpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGlpX2NvdW50ZXIpO1xuICAgICAgICAgICAgZXZlcnlfMjAwX2ZyYW1lcygpO1xuICAgICAgICAgICAgaWlfY291bnRlciA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgc2ltQm9hcmQudXBkYXRlKGRlbHRhKTtcbiAgICAgICAgZGVsdGEgLT0gdGltZXN0ZXA7XG4gICAgICAgIGlmICgrK251bVVwZGF0ZVN0ZXBzID49IDEyNCkge1xuICAgICAgICAgICAgLy8gc3RvcCgpO1xuICAgICAgICAgICAgcGFuaWMoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNpbUJvYXJkLmRyYXcoKTtcblxuXG4gICAgbGV0IGcgPSBzaW1Cb2FyZC5nb2xkX29uX2ZpZWxkKCkubGVuZ3RoO1xuICAgIC8vIGNvbnNvbGUubG9nKGcpO1xuXG4gICAgaWYgKGcgPiAwKSB7XG4gICAgICAgIGZyYW1lSUQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobWFpbkxvb3ApOyBcbiAgICB9IGVsc2UgeyBcbiAgICAgICAgc3RvcCgpOyBcbiAgICAgICAgYWZ0ZXJTaW0oKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBldmVyeV8yMDBfZnJhbWVzICgpIHtcbiAgICAgICAgc2ltQm9hcmQudHdvU2VjVXBkYXRlKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZXZlcnlfNzVfZnJhbWVzICgpIHtcbiAgICAgICAgc2ltQm9hcmQub25lU2VjVXBkYXRlKCk7XG4gICAgfVxuXG59XG5cbnN0YXJ0KCk7XG5cbmZ1bmN0aW9uIGFmdGVyU2ltICgpIHtcbiAgICBzaW1Cb2FyZC5mbGVldHMuZm9yRWFjaCgoZixpKSA9PiB7XG4gICAgICAgIGxldCBnb2xkID0gZi5zX2FycmF5LnJlZHVjZSgoYSxzLGkpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBhK3MuZ29sZDtcbiAgICAgICAgfSwgMCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGkrMSwgZi5iYW5uZXIsIGdvbGQpO1xuICAgIH0pO1xufSIsImltcG9ydCB7IHJhbmRvbU1NLCBzcXVhcmVOdW0gfSBmcm9tICcuL3V0aWxzLmpzJztcbmltcG9ydCB7R29sZFBpZWNlfSBmcm9tICcuL0dvbGRQaWVjZS5qcyc7XG5pbXBvcnQgeyBGbGVldCB9IGZyb20gJy4vRmxlZXQuanMnO1xuXG5leHBvcnQgY2xhc3MgQm9hcmQge1xuXHRjb25zdHJ1Y3RvciAoKSB7XG5cdFx0dGhpcy5udW1fZ29sZCA9IDkwMDtcblx0XHR0aGlzLm1vbmV5X3Blcl9mbGVldCA9IDE1MDAwMDtcblx0XHR0aGlzLkRPTWggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYm9hcmQnKTtcblx0XHR0aGlzLmZsZWV0cyA9IFtcblx0XHRcdG5ldyBGbGVldCgncmVkJyx0aGlzLm1vbmV5X3Blcl9mbGVldCx7YXZlcmFnZToyMCxzd2lmdDowLHRyYW5zcG9ydDowLGd1bm5lcjowLHNwZWVkZXI6MH0pLFxuXHRcdFx0bmV3IEZsZWV0KCdncmVlbicsdGhpcy5tb25leV9wZXJfZmxlZXQse2F2ZXJhZ2U6MjAsc3dpZnQ6MCx0cmFuc3BvcnQ6MCxndW5uZXI6MCxzcGVlZGVyOjB9KSxcblx0XHRcdG5ldyBGbGVldCgnYmx1ZScsdGhpcy5tb25leV9wZXJfZmxlZXQse2F2ZXJhZ2U6MjAsc3dpZnQ6MCx0cmFuc3BvcnQ6MCxndW5uZXI6MCxzcGVlZGVyOjB9KV07XG5cdFx0dGhpcy5nb2xkX3BpZWNlcyA9IFtdO1xuXHRcdHRoaXMuaW5pdCgpO1xuXHR9XG5cblx0cGxhY2VHb2xkICgpIHtcblx0XHRmb3IgKGxldCBpPTA7aTx0aGlzLm51bV9nb2xkO2krKykge1xuXHRcdFx0bGV0IGdwID0gbmV3IEdvbGRQaWVjZShpKTtcblx0XHRcdHRoaXMuZ29sZF9waWVjZXMucHVzaChncCk7XG5cdFx0fVxuXHR9XG5cblx0Z29sZF9vbl9maWVsZCAoKSB7XG5cdFx0bGV0IGdvZiA9IHRoaXMuZ29sZF9waWVjZXMuZmlsdGVyKGcgPT4gZy5oZWxkX2J5PT09XCJub25lXCIpO1xuXHRcdHJldHVybiBnb2Y7XG5cdH1cblxuXHRpbml0KCkge1xuXHRcdHRoaXMucGxhY2VHb2xkKCk7XG5cdFx0dGhpcy5zZXRUYXJnZXRzKHRoaXMuZmxlZXRzKTtcblx0XHR0aGlzLmZsZWV0cy5mb3JFYWNoKChmKSA9PiB7XG5cdFx0XHRmLnNfYXJyYXkuZm9yRWFjaCgocykgPT4ge1xuXHRcdFx0XHR0aGlzLkRPTWguYXBwZW5kQ2hpbGQocy5ET01oKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHRcdHRoaXMuZ29sZF9waWVjZXMuZm9yRWFjaCgoZ3ApID0+IHtcblx0XHRcdHRoaXMuRE9NaC5hcHBlbmRDaGlsZChncC5ET01oKTtcblx0XHR9KTtcblx0fVxuXG5cdHNldFRhcmdldHMoKSB7XG5cdFx0dGhpcy5mbGVldHMuZm9yRWFjaCgoZixpZHgpID0+IHtcblx0XHRcdGxldCBlbmVtaWVzID0gdGhpcy5mbGVldHMuZmlsdGVyKCAoZmYsaSkgPT4gaSAhPT0gaWR4KTtcblx0XHRcdGYuc19hcnJheS5mb3JFYWNoKChzKSA9PiB7XG5cdFx0XHRcdHMuc2V0R29sZFRhcmdldCh0aGlzLmdvbGRfb25fZmllbGQoKSk7XG5cdFx0XHRcdHMuc2V0RW5lbXlUYXJnZXQoZW5lbWllcyk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdG1ha2VBdHRhY2tzKCkge1xuXHRcdHRoaXMuZmxlZXRzLmZvckVhY2goKGYsaWR4KSA9PiB7XG5cdFx0XHRmLnNfYXJyYXkuZm9yRWFjaCgocykgPT4ge1xuXHRcdFx0XHRzLmF0dGFja0VuZW15KCk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdGRvSGl0RGV0ZWN0ICgpIHtcblx0XHR0aGlzLmZsZWV0cy5mb3JFYWNoKChmKSA9PiB7XG5cdFx0XHRmLnNfYXJyYXkuZm9yRWFjaCgocykgPT4ge1xuXHRcdFx0XHR0aGlzLmdvbGRfcGllY2VzLmZvckVhY2goKGdwKSA9PiB7XG5cdFx0XHRcdGxldCBkaXN0X3NxID0gc3F1YXJlTnVtKGdwLngtcy54KSArIHNxdWFyZU51bShncC55LXMueSk7XG5cdFx0XHRcdGlmICggZGlzdF9zcSA8IDI1ICYmIGdwLmhlbGRfYnk9PT1cIm5vbmVcIiApIHtcblx0XHRcdFx0XHR0aGlzLnJlbW92ZUdvbGQoZ3Ascyk7XG5cdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdHJlbW92ZUdvbGQgKGdwLHMpIHtcblx0XHRncC5oZWxkX2J5ID0gcy5wcm9maWxlO1xuXHRcdHMuYWNxdWlyZUdvbGQoKTtcblx0XHR0aGlzLnNldFRhcmdldHModGhpcy5mbGVldHMpO1xuXHRcdGdwLnJlbW92ZSgpO1xuXHR9XG5cblx0ZHJhdyAoKSB7XG5cdFx0dGhpcy5kb0hpdERldGVjdCgpO1xuXHRcdHRoaXMuZmxlZXRzLmZvckVhY2goKGYpID0+IHtcblx0XHRcdGYuc19hcnJheS5mb3JFYWNoKChzKSA9PiB7XG5cdFx0XHRzLmRyYXcoKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cblx0dXBkYXRlIChkZWx0YSkge1xuXHRcdHRoaXMuZmxlZXRzLmZvckVhY2goKGYpID0+IHtcblx0XHRcdGYuc19hcnJheS5mb3JFYWNoKChzKSA9PiB7XG5cdFx0XHRcdHMubW92ZShkZWx0YSk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdC8vIGhvdyB0byBtYWtlIHRoaXMgbW9yZSBmbHVpZD9cblx0b25lU2VjVXBkYXRlICgpIHtcblx0XHR0aGlzLm1ha2VBdHRhY2tzKCk7XG5cdFx0Ly8gY29uc29sZS5sb2coXCIxc2VjIFVwZGF0ZVwiKTtcblx0fVxuXG5cdHR3b1NlY1VwZGF0ZSAoKSB7XG5cdFx0dGhpcy5zZXRUYXJnZXRzKCk7XG5cdFx0Ly8gY29uc29sZS5sb2coXCIyc2VjIFVwZGF0ZVwiKTtcblx0fVxuXG59Il0sInNvdXJjZVJvb3QiOiIifQ==